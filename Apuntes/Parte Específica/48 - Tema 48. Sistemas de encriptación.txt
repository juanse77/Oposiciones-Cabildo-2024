Tema 48. Sistemas de encriptaci√≥n.

48.1. Cifrado sim√©trico.

	El cifrado sim√©trico es un m√©todo de encriptaci√≥n en el cual la misma clave se utiliza tanto para cifrar como para descifrar la informaci√≥n. Este tipo de cifrado es uno de los m√°s antiguos y ha sido utilizado durante siglos para proteger la confidencialidad de la informaci√≥n. A continuaci√≥n, explico sus conceptos clave y doy varios ejemplos:

	Caracter√≠sticas del Cifrado Sim√©trico

		Clave √önica para Cifrado y Descifrado: En el cifrado sim√©trico, tanto el remitente como el receptor deben poseer la misma clave secreta. Esta clave es utilizada para convertir el texto plano (la informaci√≥n original) en texto cifrado (informaci√≥n encriptada) y viceversa.

		Rapidez y Eficiencia: Este tipo de cifrado es generalmente m√°s r√°pido y eficiente que el cifrado asim√©trico, ya que implica operaciones matem√°ticas menos complejas. Por ello, es ideal para encriptar grandes vol√∫menes de datos.

		Seguridad Basada en la Clave Secreta: La seguridad del cifrado sim√©trico depende en gran medida de la clave. Si un atacante obtiene acceso a la clave, puede tanto cifrar como descifrar los mensajes. Por lo tanto, la clave debe mantenerse en secreto.

		Dificultad para el Intercambio Seguro de Claves: Uno de los principales desaf√≠os del cifrado sim√©trico es c√≥mo intercambiar la clave de manera segura entre las partes involucradas. Este problema se conoce como el "problema de distribuci√≥n de claves".

	Tipos de Cifrado Sim√©trico

		El cifrado sim√©trico puede ser clasificado en dos tipos principales:

		- Cifrado por Bloques:

			Funcionamiento: Divide el texto en bloques de longitud fija y cifra cada bloque por separado.
		
			Ejemplos:

				* AES (Advanced Encryption Standard): Uno de los est√°ndares m√°s utilizados en la actualidad. AES soporta claves de 128, 192, y 256 bits.

				* DES (Data Encryption Standard): Un est√°ndar antiguo que ha sido en gran medida reemplazado por AES debido a sus vulnerabilidades.

				* Triple DES (3DES): Una versi√≥n m√°s segura de DES que aplica el algoritmo DES tres veces con diferentes claves.

		- Cifrado de Flujo:

			Funcionamiento: Cifra los datos bit a bit o byte a byte. Es m√°s adecuado para flujos de datos continuos, como la transmisi√≥n de datos en tiempo real.

			Ejemplos:

				* RC4: Un algoritmo de cifrado de flujo ampliamente utilizado en el pasado, aunque ya no se considera seguro debido a sus vulnerabilidades.

	Aplicaciones del Cifrado Sim√©trico

		Transmisi√≥n Segura de Datos: Utilizado en protocolos de seguridad como SSL/TLS para proteger las comunicaciones en Internet.

		Protecci√≥n de Datos Almacenados: Utilizado para cifrar archivos, discos duros, bases de datos y otros almacenamientos de datos.

		Autenticaci√≥n y Firmas Digitales: Aunque el cifrado sim√©trico no se usa directamente para autenticaci√≥n o firmas digitales, puede combinarse con t√©cnicas de cifrado asim√©trico para proporcionar estas funcionalidades.

	Desaf√≠os y Consideraciones

		Distribuci√≥n Segura de Claves: Es fundamental establecer un canal seguro para el intercambio de claves, lo cual puede ser un reto en sistemas abiertos o en redes distribuidas.

		Escalabilidad: A medida que el n√∫mero de participantes en el sistema crece, tambi√©n aumenta el n√∫mero de claves que deben ser gestionadas de manera segura.

		Actualizaci√≥n de Claves: Es necesario cambiar las claves de forma peri√≥dica para mantener la seguridad.

	Conclusi√≥n

		El cifrado sim√©trico sigue siendo un componente vital en muchos sistemas de seguridad modernos debido a su rapidez y eficiencia. Sin embargo, su uso debe ser cuidadosamente considerado, especialmente en lo que respecta a la gesti√≥n y distribuci√≥n de claves.

48.2. Cifrado asim√©trico.

	El cifrado asim√©trico, tambi√©n conocido como criptograf√≠a de clave p√∫blica, es un tipo de criptograf√≠a que utiliza un par de claves: una clave p√∫blica para cifrar la informaci√≥n y una clave privada para descifrarla. A diferencia del cifrado sim√©trico, donde se usa la misma clave para cifrar y descifrar, en el cifrado asim√©trico las claves son diferentes pero est√°n matem√°ticamente relacionadas.

	Caracter√≠sticas del Cifrado Asim√©trico

		Par de Claves: Cada usuario en un sistema de cifrado asim√©trico posee un par de claves:

			- Clave P√∫blica: Se comparte abiertamente y puede ser conocida por cualquier persona. Esta clave se utiliza para cifrar los mensajes dirigidos al propietario de la clave.

			- Clave Privada: Se mantiene en secreto y solo es conocida por su propietario. Esta clave se utiliza para descifrar los mensajes que fueron cifrados con la clave p√∫blica correspondiente.

		Seguridad Basada en Problemas Matem√°ticos Complejos: La seguridad del cifrado asim√©trico se basa en la dificultad de resolver ciertos problemas matem√°ticos, como la factorizaci√≥n de n√∫meros grandes (usada en RSA) o el logaritmo discreto (usado en Diffie-Hellman y DSA).

		No Requiere Intercambio de Claves Secreto: A diferencia del cifrado sim√©trico, donde ambas partes deben tener la misma clave secreta, en el cifrado asim√©trico solo se intercambia la clave p√∫blica. Esto elimina el problema de distribuci√≥n de claves de manera segura.

		Lento en Comparaci√≥n con el Cifrado Sim√©trico: El cifrado asim√©trico es computacionalmente m√°s costoso y m√°s lento que el cifrado sim√©trico. Por esta raz√≥n, a menudo se utiliza para cifrar peque√±as cantidades de datos o para intercambiar claves que luego se usan en un esquema de cifrado sim√©trico.

	Principales Algoritmos de Cifrado Asim√©trico

		- RSA (Rivest-Shamir-Adleman):

			Es uno de los algoritmos de cifrado asim√©trico m√°s conocidos y ampliamente utilizados. Su seguridad se basa en la dificultad de factorizar n√∫meros grandes en sus factores primos. RSA se utiliza en diversas aplicaciones como SSL/TLS para comunicaciones seguras, PGP para correo electr√≥nico seguro, y en sistemas de firmas digitales.

		- ECC (Criptograf√≠a de Curva El√≠ptica):

			Utiliza las propiedades de las curvas el√≠pticas sobre cuerpos finitos para proporcionar seguridad. Ofrece el mismo nivel de seguridad que RSA pero con claves mucho m√°s cortas, lo que mejora la eficiencia y el rendimiento. Es utilizado en dispositivos con recursos limitados, como dispositivos m√≥viles y tarjetas inteligentes.

		- ElGamal:

			Basado en el problema del logaritmo discreto, similar a Diffie-Hellman. Utilizado principalmente para cifrado de datos y firma digital. 
	
		- DSA (Digital Signature Algorithm):

			Especificado como parte del Est√°ndar Digital de Firma (DSS). Se utiliza principalmente para la autenticaci√≥n y la verificaci√≥n de la integridad de los mensajes.

		- Diffie-Hellman:

			Utilizado principalmente para el intercambio de claves de manera segura a trav√©s de un canal inseguro. No es un m√©todo de cifrado en s√≠ mismo, pero se usa para establecer una clave compartida segura que luego se puede usar con algoritmos de cifrado sim√©trico.

		- Aplicaciones del Cifrado Asim√©trico

			Intercambio Seguro de Claves: Se utiliza para intercambiar claves sim√©tricas de manera segura. Esto es com√∫n en protocolos como SSL/TLS, que se utilizan para establecer conexiones seguras en Internet.

			Autenticaci√≥n y Firmas Digitales: El cifrado asim√©trico permite la autenticaci√≥n de la identidad de las partes en una comunicaci√≥n y la firma digital de documentos. Las firmas digitales garantizan la integridad del mensaje y autentican al remitente.

			Cifrado de Correos Electr√≥nicos: Tecnolog√≠as como PGP (Pretty Good Privacy) y GPG (GNU Privacy Guard) utilizan cifrado asim√©trico para proteger la privacidad de los correos electr√≥nicos.

			Seguridad de Redes y Sistemas: Utilizado en diversas aplicaciones para proteger sistemas de redes, como VPNs (Redes Privadas Virtuales), SSH (Secure Shell), y otros protocolos de comunicaci√≥n seguros.

	Ventajas del Cifrado Asim√©trico

		- Alta Seguridad: No es necesario compartir la clave privada, lo que reduce significativamente el riesgo de comprometer la clave.

		- Escalabilidad: Es m√°s f√°cil de gestionar en sistemas grandes, ya que no se requiere una clave secreta compartida entre cada par de usuarios.

		- Autenticaci√≥n y No Repudio: Proporciona mecanismos para la autenticaci√≥n de las partes y el no repudio (una vez que se firma un mensaje, el remitente no puede negar haberlo firmado).

	Desaf√≠os del Cifrado Asim√©trico

		- Lentitud: Es m√°s lento que el cifrado sim√©trico, lo que lo hace menos pr√°ctico para cifrar grandes vol√∫menes de datos.
		
		- Gesti√≥n de Claves: Aunque elimina el problema de la distribuci√≥n de claves, introduce la necesidad de una infraestructura de gesti√≥n de claves p√∫blica (PKI), que puede ser compleja de administrar.

	Conclusi√≥n

		El cifrado asim√©trico es una herramienta poderosa en la criptograf√≠a moderna, esencial para la seguridad de las comunicaciones y la integridad de los datos. Si bien es m√°s complejo y computacionalmente intensivo que el cifrado sim√©trico, ofrece ventajas significativas en t√©rminos de seguridad y gesti√≥n de claves. En la pr√°ctica, ambos tipos de cifrado se combinan a menudo para aprovechar sus respectivas fortalezas en sistemas criptogr√°ficos h√≠bridos.

48.3. La funci√≥n hash.

	Las funciones hash son un componente fundamental de la criptograf√≠a y la seguridad inform√°tica. Se utilizan para transformar datos de entrada de cualquier tama√±o en una salida de tama√±o fijo, generalmente una cadena de caracteres, que representa una especie de "huella digital" √∫nica del conjunto de datos de entrada. Las funciones hash juegan un papel clave en la integridad de los datos, la autenticaci√≥n, y muchos otros aspectos de la seguridad digital. A continuaci√≥n, te explicar√© en detalle qu√© son, c√≥mo funcionan, y sus aplicaciones.

	¬øQu√© es una Funci√≥n Hash?

		Una funci√≥n hash es un algoritmo que toma una entrada (o "mensaje") y devuelve una cadena de longitud fija, que generalmente se denomina "valor hash" o "digest". Independientemente del tama√±o de la entrada, la salida siempre tiene una longitud fija. Las funciones hash se utilizan ampliamente en criptograf√≠a, aunque tambi√©n tienen aplicaciones en otras √°reas de la inform√°tica, como la b√∫squeda de datos y la integridad de la informaci√≥n.

	Propiedades de una Buena Funci√≥n Hash Criptogr√°fica

		Determin√≠stica: Para un mismo dato de entrada, la funci√≥n hash siempre generar√° el mismo valor de salida.

		Salida de Longitud Fija: Independientemente del tama√±o del dato de entrada, la salida del hash tendr√° una longitud fija (por ejemplo, 256 bits para SHA-256).

		R√°pida de Calcular: La funci√≥n hash debe ser capaz de generar el hash r√°pidamente para que pueda utilizarse en sistemas en tiempo real y aplicaciones de alto rendimiento.

		Preimagen Resistente: Dado un valor hash ‚Ñé, debe ser computacionalmente inviable encontrar cualquier entrada ùë• tal que ‚Ñéùëéùë†‚Ñé(ùë•)=‚Ñé.

		Resistencia a Colisiones: Es computacionalmente inviable encontrar dos entradas distintas ùë• y ùë¶ tales que ‚Ñéùëéùë†‚Ñé(ùë•) = ‚Ñéùëéùë†‚Ñé(ùë¶). Esto asegura la unicidad de la "huella digital".

		Efecto Avalanche (Avalancha): Un peque√±o cambio en la entrada debe producir un cambio significativo e impredecible en el hash resultante. Por ejemplo, cambiar una sola letra en una entrada deber√≠a cambiar la mayor√≠a de los bits en el hash.

	Principales Algoritmos de Funciones Hash Criptogr√°ficas

		MD5 (Message Digest Algorithm 5):
			
			- Genera un valor hash de 128 bits.
			- Muy popular en el pasado, pero ahora considerado inseguro debido a la capacidad de encontrar colisiones (diferentes entradas que generan el mismo hash).
			- A√∫n se utiliza en aplicaciones no cr√≠ticas donde la seguridad no es un factor determinante, como la verificaci√≥n de integridad de archivos.

		SHA-1 (Secure Hash Algorithm 1):

			- Produce un valor hash de 160 bits.
			- Como MD5, SHA-1 ha sido ampliamente utilizado, pero se considera obsoleto debido a las vulnerabilidades encontradas que permiten colisiones.
			- Ha sido reemplazado en la mayor√≠a de los sistemas modernos por algoritmos m√°s seguros como SHA-256.

		SHA-2 (Secure Hash Algorithm 2):

			- Incluye varias variantes como SHA-224, SHA-256, SHA-384, y SHA-512, que generan valores hash de diferentes tama√±os (224, 256, 384, y 512 bits respectivamente).
			- SHA-256 y SHA-512 son los m√°s utilizados en sistemas de seguridad actuales, como blockchain (Bitcoin), SSL/TLS, y m√°s.
			- Proporcionan una mayor seguridad en comparaci√≥n con sus predecesores.

		SHA-3 (Secure Hash Algorithm 3):

			- Tambi√©n conocido como Keccak, es el √∫ltimo est√°ndar de la familia SHA.
			- Fue seleccionado como ganador de una competici√≥n organizada por NIST (National Institute of Standards and Technology) para encontrar una nueva funci√≥n hash.
			- Dise√±ado para ser m√°s resistente a diferentes tipos de ataques en comparaci√≥n con SHA-2.

		RIPEMD (RACE Integrity Primitives Evaluation Message Digest):

			- Parte de una familia de funciones hash desarrolladas en Europa.
			- RIPEMD-160 es una versi√≥n mejorada que ofrece una seguridad similar a SHA-1.
			- Aplicaciones de las Funciones Hash
		
	Verificaci√≥n de Integridad de Datos:

		Las funciones hash se utilizan para asegurar que los datos no han sido alterados. Por ejemplo, al descargar un archivo, su valor hash se puede comparar con el valor original proporcionado por el remitente para verificar la integridad.

	Firmas Digitales y Certificados Digitales:

		Las funciones hash son fundamentales para crear firmas digitales. Se utiliza un hash del mensaje para crear la firma digital, lo que permite verificar la autenticidad y la integridad del mensaje sin necesidad de revelar la clave privada.

	Almacenamiento Seguro de Contrase√±as:

		En lugar de almacenar contrase√±as en texto claro, se almacena su hash. Al verificar la contrase√±a, se compara el hash de la entrada con el hash almacenado.

	Algoritmos de Prueba de Trabajo (Proof of Work):

		En criptomonedas como Bitcoin, los algoritmos hash (como SHA-256) se utilizan en el proceso de miner√≠a para validar transacciones y asegurar la red.

	Funciones de Derivaci√≥n de Clave:

		Se utilizan funciones hash junto con t√©cnicas como HMAC (Hash-based Message Authentication Code) para derivar claves criptogr√°ficas seguras a partir de contrase√±as.

	Desaf√≠os y Consideraciones en el Uso de Funciones Hash

		Colisiones: A pesar de la resistencia a colisiones que deben tener las funciones hash criptogr√°ficas, no es imposible que ocurran. Los ataques de colisi√≥n (encontrar dos entradas que resultan en el mismo hash) son una preocupaci√≥n para algoritmos m√°s antiguos como MD5 y SHA-1.

		Ataques de Preimagen e Inversi√≥n: A medida que la potencia de procesamiento aumenta, ciertos algoritmos de hash pueden volverse vulnerables a ataques de fuerza bruta que intenten invertir el hash para recuperar la entrada original.

		Tama√±o del Hash: Cuanto mayor sea el tama√±o del hash, m√°s dif√≠cil es encontrar colisiones, pero tambi√©n aumenta el espacio de almacenamiento y los recursos de procesamiento requeridos.

	Conclusi√≥n

		Las funciones hash son herramientas poderosas y vers√°tiles en la criptograf√≠a y la seguridad inform√°tica. Se utilizan para garantizar la integridad de los datos, proteger contrase√±as, autenticar identidades y asegurar transacciones. A medida que evoluciona la tecnolog√≠a y aumentan las capacidades de los atacantes, tambi√©n lo hacen las funciones hash y los est√°ndares criptogr√°ficos asociados. Los algoritmos como SHA-256 y SHA-3 ofrecen una seguridad s√≥lida para la mayor√≠a de las aplicaciones actuales, aunque es crucial mantenerse actualizado con los est√°ndares y pr√°cticas recomendadas.

A√±adido: Algoritmos bcrypt y scrypt:

	bcrypt y scrypt son algoritmos de hash dise√±ados espec√≠ficamente para el almacenamiento seguro de contrase√±as. A diferencia de los algoritmos de hash tradicionales como MD5 o SHA-256, que est√°n dise√±ados principalmente para la velocidad y la integridad de los datos, bcrypt y scrypt se centran en ser lentos y seguros para evitar ataques de fuerza bruta y ataques de diccionario.

	bcrypt:

		bcrypt es un algoritmo de hash dise√±ado para proteger contrase√±as, desarrollado por Niels Provos y David Mazi√®res en 1999. Se basa en el cifrado Blowfish y est√° dise√±ado espec√≠ficamente para ser computacionalmente costoso, lo que lo hace resistente a los ataques de fuerza bruta.

	Caracter√≠sticas de bcrypt

		Funci√≥n de Derivaci√≥n de Clave Lenta:

			bcrypt est√° dise√±ado para ser lento. Utiliza un factor de costo ajustable que controla la complejidad del c√°lculo, lo que significa que el tiempo necesario para calcular el hash puede aumentarse a medida que mejora la potencia de c√≥mputo de los atacantes.
	
		Sal (Salt) Aleatoria:

			bcrypt incluye una sal de 128 bits generada aleatoriamente que se combina con la contrase√±a antes de aplicar el algoritmo de hash. Esto significa que dos contrase√±as id√©nticas tendr√°n hashes diferentes, lo que protege contra ataques de tablas de b√∫squeda precomputadas (tablas Rainbow).

		Resistente a Ataques de Fuerza Bruta y Diccionario:

			Debido a su lentitud y al uso de sal, bcrypt es muy resistente a ataques de fuerza bruta y diccionario, ya que cada intento requiere un tiempo significativo.

		Factores de Costo Configurables:

			bcrypt permite ajustar la dificultad del c√°lculo mediante un par√°metro llamado "cost factor" o "work factor". Cuanto mayor sea este factor, m√°s tiempo se tarda en calcular un hash, lo que aumenta la seguridad.

		Amplia Adopci√≥n y Soporte:

			bcrypt es ampliamente utilizado y compatible con muchos lenguajes de programaci√≥n y frameworks. Es el est√°ndar de facto para almacenar contrase√±as de manera segura en aplicaciones web y bases de datos.

	Uso de bcrypt:

		bcrypt se utiliza principalmente en sistemas de autenticaci√≥n para proteger las contrase√±as de los usuarios. Es una opci√≥n recomendada para desarrolladores y administradores de sistemas que buscan una manera segura de almacenar contrase√±as, especialmente cuando se usa con un factor de costo apropiado.


	scrypt:

		scrypt es otro algoritmo de hash seguro dise√±ado espec√≠ficamente para proteger contrase√±as. Fue desarrollado en 2009 por Colin Percival para ser utilizado en el sistema de respaldo Tarsnap. scrypt fue dise√±ado para ser intensivo en memoria y computacionalmente costoso, lo que lo hace a√∫n m√°s resistente a ataques de fuerza bruta que bcrypt.

		Caracter√≠sticas de scrypt:

			Funci√≥n de Derivaci√≥n de Clave Intensiva en Memoria:

				scrypt est√° dise√±ado para ser intensivo tanto en CPU como en memoria, lo que dificulta su implementaci√≥n en hardware especializado (como ASICs o GPUs). Esto lo hace m√°s resistente a ataques a gran escala, donde se intentan muchas combinaciones posibles simult√°neamente.

			Sal (Salt) Aleatoria y Factores de Costo:

				Al igual que bcrypt, scrypt utiliza una sal aleatoria para asegurar que dos contrase√±as iguales tengan hashes diferentes. Tambi√©n permite ajustar el tiempo de c√°lculo y la cantidad de memoria utilizada a trav√©s de par√°metros de costo, llamados N, r, y p.

			Resistencia a Ataques de Fuerza Bruta y Hardware Especializado:

				Dado que scrypt requiere una gran cantidad de memoria, es m√°s dif√≠cil de paralelizar en hardware especializado, como GPUs o FPGAs, que son eficientes en realizar m√∫ltiples c√°lculos en paralelo pero tienen limitaciones de memoria.

			Configuraci√≥n Flexible para la Memoria y el Tiempo de C√°lculo:

				Los par√°metros de scrypt (N, r, p) permiten ajustar la cantidad de memoria y el tiempo de c√°lculo necesario para generar el hash. Esto lo hace adaptable a diferentes niveles de seguridad y permite aumentar la resistencia contra ataques a medida que las capacidades computacionales de los atacantes aumentan.

			Adopci√≥n en Aplicaciones de Alta Seguridad:

				Aunque es m√°s reciente que bcrypt, scrypt ha sido adoptado por aplicaciones que requieren un nivel m√°s alto de seguridad, como criptomonedas (por ejemplo, Litecoin) y sistemas de almacenamiento de datos seguros.

		Uso de scrypt:

			scrypt es ideal para aplicaciones que requieren un almacenamiento seguro de contrase√±as donde la memoria y la seguridad son consideraciones clave. Se utiliza en sistemas de autenticaci√≥n de usuarios, protecci√≥n de contrase√±as y en ciertas criptomonedas y sistemas de almacenamiento de datos donde se necesita una derivaci√≥n de clave intensiva en memoria.


	Comparaci√≥n entre bcrypt y scrypt:

		Caracter√≠stica			bcrypt			scrypt
		A√±o de Creaci√≥n			1999			2009
		Resistencia a Ataques	Resistente a ataques de fuerza bruta y diccionario debido a la lentitud y la sal aleatoria.	M√°s resistente a ataques debido a su uso intensivo de memoria y CPU.
		Sal Aleatoria			S√≠, de 128 bits		S√≠, configurable
		Factores de Costo			S√≠, configurables (cost factor)		S√≠, configurables (N, r, p)
		Intensivo en Memoria		No			S√≠
		Resistencia a Hardware Especializado		Moderada		Alta
		Velocidad			M√°s r√°pido que scrypt	M√°s lento pero m√°s seguro contra ataques paralelos
		Adopci√≥n			Amplia, est√°ndar de facto	Menos com√∫n, pero creciente

	Conclusi√≥n

		Tanto bcrypt como scrypt son algoritmos excelentes para el almacenamiento seguro de contrase√±as, pero ofrecen diferentes niveles de protecci√≥n:

			bcrypt: Es ampliamente utilizado y proporciona una excelente seguridad ajustable con un factor de costo configurable. Es m√°s adecuado para la mayor√≠a de las aplicaciones web y sistemas de autenticaci√≥n donde la velocidad es una consideraci√≥n, pero se requiere seguridad.

			scrypt: Es m√°s seguro contra ataques con hardware especializado debido a su consumo intensivo de memoria. Es ideal para aplicaciones donde se espera un atacante con recursos significativos, como en ciertas criptomonedas o sistemas cr√≠ticos.

		Ambos son opciones recomendadas para proteger contrase√±as, pero la elecci√≥n entre uno y otro depende del contexto de seguridad y los recursos de hardware del sistema donde se implementar√°n.
